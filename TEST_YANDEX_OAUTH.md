# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Yandex OAuth

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

- [x] Client ID –∏ Client Secret –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `.env.local`
- [x] Redirect URI –≤ Yandex –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ `http://localhost:5000/api/auth/yandex/callback`
- [ ] –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ OAuth

## üöÄ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω

```bash
npm run dev
```

–°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –Ω–∞ –ø–æ—Ä—Ç—É 5000 (–∏–ª–∏ –¥—Ä—É–≥–æ–º, —É–∫–∞–∑–∞–Ω–Ω–æ–º –≤ PORT).

### 2. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞:
```
http://localhost:5173/login
```

### 3. –ù–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å"

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
- –ö–Ω–æ–ø–∫–∞ —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º –Ø–Ω–¥–µ–∫—Å
- –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ - –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ø–Ω–¥–µ–∫—Å

### 4. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –≤ –Ø–Ω–¥–µ–∫—Å

–ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏:
1. –û—Ç–∫—Ä–æ–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ Yandex –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
2. –í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –Ø–Ω–¥–µ–∫—Å
3. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
4. –í—ã –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –æ–±—Ä–∞—Ç–Ω–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
- ‚úÖ –í—ã –¥–æ–ª–∂–Ω—ã –ø–æ–ø–∞—Å—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É (`/`)
- ‚úÖ –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥"
- ‚úÖ –í—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–µ

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ï—Å–ª–∏ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –Ø–Ω–¥–µ–∫—Å

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:**
- –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
- –í–∫–ª–∞–¥–∫–∞ "Console" - –Ω–µ—Ç –ª–∏ –æ—à–∏–±–æ–∫
- –í–∫–ª–∞–¥–∫–∞ "Network" - –∫–∞–∫–æ–π –æ—Ç–≤–µ—Ç –æ—Ç `/api/auth/yandex`

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:**
- –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω —Å–µ—Ä–≤–µ—Ä, –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏
- –ò—â–∏—Ç–µ –æ—à–∏–±–∫–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å `YANDEX_CLIENT_ID`

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```bash
# –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –ø—Ä–æ–µ–∫—Ç–∞
echo $YANDEX_CLIENT_ID
# –î–æ–ª–∂–µ–Ω –≤—ã–≤–µ—Å—Ç–∏: 2710959716ba49f48959f7a533e7aadd
```

### –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ "Invalid OAuth state"

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ cookies —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ (–º–æ–∂–µ—Ç –±—ã—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤—â–∏–∫ cookies)

### –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Yandex

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Redirect URI:**
- –î–æ–ª–∂–µ–Ω –±—ã—Ç—å: `http://localhost:5000/api/auth/yandex/callback`
- –ù–ï –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å Supabase URL

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:**
- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏ –æ–± –æ–±–º–µ–Ω–µ –∫–æ–¥–∞ –Ω–∞ —Ç–æ–∫–µ–Ω
- –ò—â–∏—Ç–µ –æ—à–∏–±–∫–∏ —Å `YANDEX_CLIENT_SECRET`

## ‚úÖ –£—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –í—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å
2. –í –±–∞–∑–µ Supabase —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–µ—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
3. –ò–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
4. –°–µ—Å—Å–∏—è Supabase –∞–∫—Ç–∏–≤–Ω–∞

## üéâ –ì–æ—Ç–æ–≤–æ!

–ï—Å–ª–∏ OAuth —Ä–∞–±–æ—Ç–∞–µ—Ç - –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ!

